<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø¯Ø§Ù†Ù„ÙˆØ¯ Hiddify VPN</title>
<style>
/* local Vazir font will be used if present */
@font-face{font-family:Vazir; src: url('fonts/Vazir.woff2') format('woff2'); font-weight:400; font-style:normal; font-display:swap;}
:root{--accent:#00e5ff; --glass: rgba(255,255,255,0.06); --btn:#4CAF50; --orange:#ff9800}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family: Vazir, Tahoma, Arial, sans-serif;
  background: url('Bak_Hiddfiy.mp4') no-repeat center center fixed;
  background-size: cover;
  color:#fff;
  direction:rtl;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  padding-bottom:40px;
}
header{position:sticky;top:0;z-index:40;background:rgba(0,0,0,0.65);padding:12px 10px;text-align:center}
header nav a{color:var(--accent);text-decoration:none;margin:0 12px;font-weight:700;font-size:17px}
header nav a:hover{text-decoration:underline}
.container{max-width:1100px;margin:20px auto;padding:18px}
h1{text-align:center;margin-bottom:10px;font-size:26px}
.pcenter{text-align:center;margin-bottom:16px}
.auto-download{display:flex;justify-content:center;margin-bottom:18px}
.auto-download button{background:var(--orange);border:none;color:#fff;padding:10px 18px;border-radius:10px;font-weight:700;cursor:pointer}
.cards{display:flex;flex-wrap:wrap;gap:20px;justify-content:center}
.card{width:280px;padding:18px;border-radius:14px;background:var(--glass);backdrop-filter:blur(8px);box-shadow:0 6px 18px rgba(0,0,0,0.45);transition:.28s;display:flex;flex-direction:column;align-items:center}
.card:hover{transform:translateY(-8px);box-shadow:0 18px 40px rgba(0,0,0,0.55)}
.card img{width:72px;height:72px;object-fit:contain;margin-bottom:10px}
.card h2{margin-bottom:8px;color:#fff}
select{width:100%;padding:9px;border-radius:8px;border:none;margin-bottom:10px;font-size:15px;background:rgba(255,255,255,0.03);color:#fff;outline:none}
button.download-btn{width:100%;padding:10px;border-radius:8px;border:none;background:var(--btn);color:#fff;font-weight:700;cursor:pointer}
.guide{margin-top:28px;background:rgba(0,0,0,0.5);padding:16px;border-radius:10px;line-height:1.6;color:#eee}
footer{margin-top:26px;text-align:center;padding:12px;background:rgba(0,0,0,0.65);border-radius:8px}
footer a{color:var(--accent);text-decoration:none;font-weight:700}

/* modal */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:90}
.modal{width:min(760px,92%);background:rgba(255,255,255,0.06);border-radius:12px;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,0.6);color:#fff;direction:rtl}
.modal h3{margin-bottom:12px;text-align:center;font-size:20px}
.modal p{margin-bottom:10px;line-height:1.6}
.modal .links a{display:inline-block;margin:6px 8px;color:var(--accent);text-decoration:none}
.modal .actions{display:flex;justify-content:center;margin-top:14px;gap:8px}
.modal .actions button{background:var(--btn);border:none;color:#fff;padding:10px 12px;border-radius:8px;cursor:pointer;font-weight:700}
.small-note{font-size:13px;color:#ddd;margin-top:6px;text-align:center}

/* responsive */
@media (max-width:700px){
  .card{width:92%}
  header nav a{font-size:15px;margin:0 8px}
}
</style>
</head>
<body>
<header>
  <nav>
    <a href="#android">Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯</a>
    <a href="#windows">ÙˆÛŒÙ†Ø¯ÙˆØ²</a>
    <a href="#mac">Ù…Ú©</a>
    <a href="#linux">Ù„ÛŒÙ†ÙˆÚ©Ø³</a>
  </nav>
</header>

<!-- Intro modal -->
<div id="introModal" class="modal-backdrop" role="dialog" aria-modal="true">
  <div class="modal" role="document">
    <h3>âœ¨ OWNER: <a href="https://t.me/Puriya73" target="_blank">@Puriya73</a></h3>
    <p>ğŸ“¢ Ø¯Ø± Ø§ÛŒÙ† Ú©Ø§Ù†Ø§Ù„ØŒ Ù‡Ø¯Ù Ù…Ø§ ÙØ±Ø§Ù‡Ù… Ú©Ø±Ø¯Ù† <strong>Ø§ØªØµØ§Ù„ Ù¾Ø§ÛŒØ¯Ø§Ø± Ùˆ Ø³Ø±ÛŒØ¹</strong> Ø¨Ù‡ Ø§ÛŒÙ†ØªØ±Ù†Øª Ø§Ø³Øª. ğŸŒ Ø¨Ø§ Ø§Ø±Ø§Ø¦Ù‡ Ø§Ú©Ø§Ù†Øªâ€ŒÙ‡Ø§ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ Ùˆ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø³Ø±ÛŒØ¹ Ù‡Ù…ÛŒØ´Ù‡ Ù‡Ù…Ø±Ø§Ù‡ Ø´Ù…Ø§ Ù‡Ø³ØªÛŒÙ….</p>
    <p class="links">
      <a href="https://t.me/Academi_team" target="_blank">Ú¯Ø±ÙˆÙ‡: @Academi_team</a>
      <a href="https://t.me/Academii_support" target="_blank">Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ: @Academii_support</a>
    </p>
    <p style="text-align:center">ğŸ’“ Ù‡Ù…Ø±Ø§Ù‡ÛŒ Ø´Ù…Ø§ Ø¨Ø§Ø¹Ø« Ø§ÙØªØ®Ø§Ø± Ù…Ø§Ø³Øª ğŸ’“</p>
    <div class="actions">
      <button onclick="window.open('https://t.me/Puriya73','_blank')">Ø¹Ø¶ÙˆÛŒØª Ø¯Ø± Ú©Ø§Ù†Ø§Ù„</button>
      <button onclick="window.open('https://t.me/Academi_team','_blank')">Ø¹Ø¶ÙˆÛŒØª Ø¯Ø± Ú¯Ø±ÙˆÙ‡</button>
      <button onclick="window.open('https://t.me/Academii_support','_blank')">Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ</button>
      <button id="introAccept" style="background:#6c757d">ØªØ£ÛŒÛŒØ¯</button>
    </div>
  </div>
</div>

<div class="container" id="mainContent" aria-hidden="true">
  <div class="auto-download"><button id="autoBtn">Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø®ÙˆØ¯Ú©Ø§Ø±</button></div>
  <h1>Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø¢Ø®Ø±ÛŒÙ† Ù†Ø³Ø®Ù‡ Hiddify VPN</h1>
  <p class="pcenter">Ø§ÛŒÙ† ØµÙØ­Ù‡ Ù‡Ù…ÛŒØ´Ù‡ Ø¢Ø®Ø±ÛŒÙ† Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø§Ø² GitHub Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒÚ©Ù†Ø¯.</p>

  <div class="cards" id="cards"></div>

  <div class="guide" id="guide">
    <h3>Ø±Ø§Ù‡Ù†Ù…Ø§</h3>
    <p><strong>Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø®ÙˆØ¯Ú©Ø§Ø±:</strong> Ø¨Ø§ Ø²Ø¯Ù† Ø¯Ú©Ù…Ù‡ <em>Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø®ÙˆØ¯Ú©Ø§Ø±</em>ØŒ Ø³ÛŒØ³ØªÙ… Ø¹Ø§Ù…Ù„ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ø´Ù…Ø§ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ùˆ Ø¢Ø®Ø±ÛŒÙ† Ù†Ø³Ø®Ù‡ Ù…Ù†Ø§Ø³Ø¨ Ø¢Ù† Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯.</p>
    <p><strong>Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯ V7 Ùˆ V8:</strong> Ø¨Ø±Ø§ÛŒ ØªØ´Ø®ÛŒØµ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ú¯ÙˆØ´ÛŒ Ø®ÙˆØ¯ØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù… Ø¨Ø±ÛŒØ¯ â†’ ØªÙ†Ø¸ÛŒÙ…Ø§Øª â†’ Ø¯Ø±Ø¨Ø§Ø±Ù‡ (About) ÛŒØ§ Ø¯Ø§Ø®Ù„ Ø¨Ø®Ø´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø³ØªÚ¯Ø§Ù‡. Ø¨Ù‡ Ø¯Ù†Ø¨Ø§Ù„ Ø¹Ø¨Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒÛŒ Ù…Ø§Ù†Ù†Ø¯ <code>arm64</code> ÛŒØ§ <code>armeabi-v7a</code> Ø¨Ú¯Ø±Ø¯ÛŒØ¯. Ø§Ú¯Ø± Ù…Ø·Ù…Ø¦Ù† Ù†ÛŒØ³ØªÛŒØ¯ Ú¯Ø²ÛŒÙ†Ù‡ <em>Universal</em> Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.</p>
    <p class="small-note">Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ Ùˆ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ù…Ø³ØªÙ‚ÛŒÙ…Ø§Ù‹ Ø§Ø² Ø±ÛŒÙ„ÛŒØ²Ù‡Ø§ÛŒ Ø±Ø³Ù…ÛŒ Hiddify Ø±ÙˆÛŒ GitHub Ø®ÙˆØ§Ù†Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯.</p>
  </div>

  <footer>
    <p>Ø³Ø§Ø²Ù†Ø¯Ù‡: <a href="https://t.me/MahdiAGM0" target="_blank">@MahdiAGM0</a> â€” ØªÙ„Ú¯Ø±Ø§Ù…: <a href="https://t.me/Academii73" target="_blank">@Academii73</a></p>
    <p><a href="https://github.com/hiddify/hiddify-next/releases" target="_blank">Hiddify GitHub Releases</a></p>
  </footer>
</div>

<script>
/* CONFIG */
const REPO_OWNER = "hiddify";
const REPO_NAME = "hiddify-next";
const GITHUB_API = `https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/releases`;

/* state */
let androidFiles=[], windowsFiles=[], macFiles=[], linuxFiles=[];
let releasesList = [];

/* helpers */
function isAndroidAsset(n){ return n.endsWith('.apk'); }
function isWindowsAsset(n){ return n.endsWith('.exe') || n.endsWith('.msi'); }
function isMacAsset(n){ return n.endsWith('.dmg') || n.endsWith('.pkg'); }
function isLinuxAsset(n){ return n.endsWith('.appimage') || n.endsWith('.deb') || n.endsWith('.rpm') || n.endsWith('.tar.gz'); }
function norm(s){ return (s||'').toString().toLowerCase(); }

function archMatchesAssetName(arch, name){
  name = norm(name);
  if(arch==='universal') return name.includes('universal') || name.includes('all') || (!name.includes('arm') && !name.includes('armeabi') && !name.includes('arm64'));
  if(arch==='v8') return name.includes('arm64') || name.includes('aarch64') || name.includes('arm64-v8a') || name.includes('v8');
  if(arch==='v7') return name.includes('armeabi') || name.includes('armv7') || name.includes('armeabi-v7a') || name.includes('v7');
  return false;
}

function findAssetFor(osFiles, version, exts, arch){
  const candidates = osFiles.filter(f=>f.version===version);
  if(!candidates.length) return null;
  let byArch = candidates;
  if(arch){
    const matched = candidates.filter(c=>archMatchesAssetName(arch,c.name));
    if(matched.length) byArch = matched;
  }
  for(const ext of exts){
    const found = byArch.find(c=>norm(c.name).endsWith(ext) || norm(c.name).includes(ext.replace('.','')));
    if(found) return found;
  }
  return byArch[0]||candidates[0]||null;
}

/* UI build */
function makeCard(osKey, logo, title){
  const card = document.createElement('div'); card.className='card'; card.id=osKey+'-card';
  const img = document.createElement('img'); img.src=logo; img.alt=title;
  const h2 = document.createElement('h2'); h2.innerText=title;
  const sel = document.createElement('select'); sel.id=osKey+'-version';
  if(osKey==='android'){
    const archSel = document.createElement('select'); archSel.id='android-arch';
    archSel.innerHTML = '<option value="universal">Universal</option><option value="v7">V7</option><option value="v8">V8</option>';
    card.appendChild(img); card.appendChild(h2); card.appendChild(sel); card.appendChild(archSel);
  } else {
    card.appendChild(img); card.appendChild(h2); card.appendChild(sel);
  }
  const btn = document.createElement('button'); btn.className='download-btn'; btn.innerText='Ø¯Ø§Ù†Ù„ÙˆØ¯';
  btn.addEventListener('click', ()=>{
    if(osKey==='android') downloadAndroid();
    else if(osKey==='windows') downloadWindows();
    else if(osKey==='mac') downloadMac();
    else if(osKey==='linux') downloadLinux();
  });
  card.appendChild(btn);
  return card;
}

function buildCards(){
  const container = document.getElementById('cards');
  container.innerHTML='';
  container.appendChild(makeCard('android','android_logo.svg','Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯'));
  container.appendChild(makeCard('windows','windows_logo.svg','ÙˆÛŒÙ†Ø¯ÙˆØ²'));
  container.appendChild(makeCard('mac','mac_logo.svg','Ù…Ú©'));
  container.appendChild(makeCard('linux','linux_logo.svg','Ù„ÛŒÙ†ÙˆÚ©Ø³'));
}

/* populate selects */
function populateVersions(osKey, arr){
  const sel = document.getElementById(osKey+'-version');
  sel.innerHTML='';
  const versions = [...new Set(arr.map(x=>x.version))];
  if(versions.length===0){ sel.innerHTML='<option value="">ÙØ§ÛŒÙ„ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª</option>'; return; }
  // sort by releasesList order (newest first)
  const sorted = versions.sort((a,b)=> releasesList.indexOf(b) - releasesList.indexOf(a));
  sorted.forEach(v=>{ const o=document.createElement('option'); o.value=v; o.text=v; sel.appendChild(o); });
}

/* fetch releases */
async function loadReleases(){
  try{
    const res = await fetch(GITHUB_API);
    if(!res.ok) throw new Error('GitHub API: '+res.status);
    const data = await res.json();
    releasesList = data.map(r=>r.tag_name);
    // reset arrays
    androidFiles=[]; windowsFiles=[]; macFiles=[]; linuxFiles=[];
    data.forEach(rel=>{
      const version = rel.tag_name;
      rel.assets.forEach(asset=>{
        const name = asset.name || '';
        const url = asset.browser_download_url;
        const item = {version, name, url};
        const lower = name.toLowerCase();
        if(isAndroidAsset(lower)) androidFiles.push(item);
        else if(isWindowsAsset(lower)) windowsFiles.push(item);
        else if(isMacAsset(lower)) macFiles.push(item);
        else if(isLinuxAsset(lower)) linuxFiles.push(item);
      });
    });
    // build UI and populate
    buildCards();
    populateVersions('android', androidFiles);
    populateVersions('windows', windowsFiles);
    populateVersions('mac', macFiles);
    populateVersions('linux', linuxFiles);
    // default select first (latest)
    ['android','windows','mac','linux'].forEach(os=>{ const s=document.getElementById(os+'-version'); if(s && s.options.length) s.selectedIndex=0; });
  }catch(err){
    console.error(err);
    alert('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø² GitHub: '+err.message);
  }
}

/* download handlers */
function downloadAndroid(){
  const version = document.getElementById('android-version').value;
  const arch = document.getElementById('android-arch').value;
  const asset = findAssetFor(androidFiles, version, ['.apk'], arch);
  if(asset) window.location.href = asset.url;
  else alert('ÙØ§ÛŒÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù†Ø³Ø®Ù‡/Ù…Ø¹Ù…Ø§Ø±ÛŒ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯');
}
function downloadWindows(){
  const version = document.getElementById('windows-version').value;
  const asset = findAssetFor(windowsFiles, version, ['.exe','.msi','.zip'], null);
  if(asset) window.location.href = asset.url;
  else alert('ÙØ§ÛŒÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù†Ø³Ø®Ù‡ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯');
}
function downloadMac(){
  const version = document.getElementById('mac-version').value;
  const asset = findAssetFor(macFiles, version, ['.dmg','.pkg','.zip'], null);
  if(asset) window.location.href = asset.url;
  else alert('ÙØ§ÛŒÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù†Ø³Ø®Ù‡ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯');
}
function downloadLinux(){
  const version = document.getElementById('linux-version').value;
  const asset = findAssetFor(linuxFiles, version, ['.appimage','.deb','.rpm','.tar.gz','.zip'], null);
  if(asset) window.location.href = asset.url;
  else alert('ÙØ§ÛŒÙ„ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ù†Ø³Ø®Ù‡ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯');
}

/* auto download */
function autoDownload(){
  const ua = navigator.userAgent.toLowerCase();
  if(ua.includes('android')){
    const latest = document.getElementById('android-version').value;
    let arch = 'universal';
    if(ua.includes('arm64')||ua.includes('aarch64')) arch='v8';
    else if(ua.includes('armeabi')||ua.includes('armv7')) arch='v7';
    const asset = findAssetFor(androidFiles, latest, ['.apk'], arch) || findAssetFor(androidFiles, latest, ['.apk'], 'universal');
    if(asset) window.location.href = asset.url; else alert('ÙØ§ÛŒÙ„ Ø§Ù†Ø¯Ø±ÙˆÛŒØ¯ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯');
  } else if(ua.includes('win')){
    const latest = document.getElementById('windows-version').value;
    const asset = findAssetFor(windowsFiles, latest, ['.exe','.msi','.zip'], null);
    if(asset) window.location.href = asset.url; else alert('ÙØ§ÛŒÙ„ ÙˆÛŒÙ†Ø¯ÙˆØ² Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯');
  } else if(ua.includes('mac')||ua.includes('iphone')||ua.includes('ipad')){
    const latest = document.getElementById('mac-version').value;
    const asset = findAssetFor(macFiles, latest, ['.dmg','.pkg','.zip'], null);
    if(asset) window.location.href = asset.url; else alert('ÙØ§ÛŒÙ„ Ù…Ú© Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯');
  } else {
    const latest = document.getElementById('linux-version').value;
    const asset = findAssetFor(linuxFiles, latest, ['.appimage','.deb','.rpm','.tar.gz','.zip'], null);
    if(asset) window.location.href = asset.url; else alert('ÙØ§ÛŒÙ„ Ù„ÛŒÙ†ÙˆÚ©Ø³ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯');
  }
}

/* modal behavior */
document.getElementById('introAccept').addEventListener('click', ()=>{ document.getElementById('introModal').style.display='none'; document.getElementById('mainContent').removeAttribute('aria-hidden'); try{ localStorage.setItem('hiddify_intro_seen','1'); }catch(e){} });
try{ if(localStorage.getItem('hiddify_intro_seen')){ document.getElementById('introModal').style.display='none'; document.getElementById('mainContent').removeAttribute('aria-hidden'); } }catch(e){};
document.getElementById('autoBtn').addEventListener('click', autoDownload);

/* init */
loadReleases();
</script>
</body>
</html>
